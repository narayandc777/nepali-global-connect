{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"axios","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":26,"index":26}}],"key":"e45rENb5cSu0Yeh6oC1uWb7lEp4=","exportNames":["*"],"imports":1}},{"name":"expo-constants","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":27},"end":{"line":2,"column":39,"index":66}}],"key":"pPv5KzfRT0rL6NCr7G9k0o4d1W8=","exportNames":["*"],"imports":1}},{"name":"../utils/secureStorage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":67},"end":{"line":3,"column":56,"index":123}}],"key":"VJtuFUlbX461VIgg9agIAV15XNA=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  Object.defineProperty(exports, \"api\", {\n    enumerable: true,\n    get: function () {\n      return api;\n    }\n  });\n  var _expoVirtualEnv = require(_dependencyMap[0], \"expo/virtual/env\");\n  var _axios = require(_dependencyMap[1], \"axios\");\n  var axios = _interopDefault(_axios);\n  var _expoConstants = require(_dependencyMap[2], \"expo-constants\");\n  var Constants = _interopDefault(_expoConstants);\n  var _utilsSecureStorage = require(_dependencyMap[3], \"../utils/secureStorage\");\n  var secureStorage = _interopNamespace(_utilsSecureStorage);\n  const API_URL = Constants.default.expoConfig?.extra?.EXPO_PUBLIC_BACKEND_URL || _expoVirtualEnv.env.EXPO_PUBLIC_BACKEND_URL || '';\n  const api = axios.default.create({\n    baseURL: `${API_URL}/api`,\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  });\n\n  // Request interceptor to add token\n  api.interceptors.request.use(async config => {\n    const token = await secureStorage.getItem('access_token');\n    if (token) {\n      config.headers.Authorization = `Bearer ${token}`;\n    }\n    return config;\n  }, error => {\n    return Promise.reject(error);\n  });\n\n  // Response interceptor to handle token refresh\n  api.interceptors.response.use(response => response, async error => {\n    const originalRequest = error.config;\n    if (error.response?.status === 401 && !originalRequest._retry) {\n      originalRequest._retry = true;\n      try {\n        const refreshToken = await secureStorage.getItem('refresh_token');\n        if (refreshToken) {\n          const response = await axios.default.post(`${API_URL}/api/auth/refresh`, {\n            refresh_token: refreshToken\n          });\n          const {\n            access_token,\n            refresh_token: newRefreshToken\n          } = response.data;\n          await secureStorage.setItem('access_token', access_token);\n          await secureStorage.setItem('refresh_token', newRefreshToken);\n          originalRequest.headers.Authorization = `Bearer ${access_token}`;\n          return api(originalRequest);\n        }\n      } catch (refreshError) {\n        // Refresh failed, logout user\n        await secureStorage.deleteItem('access_token');\n        await secureStorage.deleteItem('refresh_token');\n        return Promise.reject(refreshError);\n      }\n    }\n    return Promise.reject(error);\n  });\n  var _default = api;\n});","lineCount":95,"map":[[27,2,63,0,"Object"],[27,8,63,0],[27,9,63,0,"defineProperty"],[27,23,63,0],[27,24,63,0,"exports"],[27,31,63,0],[28,4,63,0,"enumerable"],[28,14,63,0],[29,4,63,0,"get"],[29,7,63,0],[29,18,63,0,"get"],[29,19,63,0],[30,6,63,0],[30,13,63,0,"_default"],[30,21,63,0],[31,4,63,0],[32,2,63,0],[33,2,7,0,"Object"],[33,8,7,0],[33,9,7,0,"defineProperty"],[33,23,7,0],[33,24,7,0,"exports"],[33,31,7,0],[34,4,7,0,"enumerable"],[34,14,7,0],[35,4,7,0,"get"],[35,7,7,0],[35,18,7,0,"get"],[35,19,7,0],[36,6,7,0],[36,13,7,0,"api"],[36,16,7,0],[37,4,7,0],[38,2,7,0],[39,2,12,3],[39,6,12,3,"_expoVirtualEnv"],[39,21,12,3],[39,24,12,3,"require"],[39,31,12,3],[39,32,12,3,"_dependencyMap"],[39,46,12,3],[40,2,1,0],[40,6,1,0,"_axios"],[40,12,1,0],[40,15,1,0,"require"],[40,22,1,0],[40,23,1,0,"_dependencyMap"],[40,37,1,0],[41,2,1,0],[41,6,1,0,"axios"],[41,11,1,0],[41,14,1,0,"_interopDefault"],[41,29,1,0],[41,30,1,0,"_axios"],[41,36,1,0],[42,2,2,0],[42,6,2,0,"_expoConstants"],[42,20,2,0],[42,23,2,0,"require"],[42,30,2,0],[42,31,2,0,"_dependencyMap"],[42,45,2,0],[43,2,2,0],[43,6,2,0,"Constants"],[43,15,2,0],[43,18,2,0,"_interopDefault"],[43,33,2,0],[43,34,2,0,"_expoConstants"],[43,48,2,0],[44,2,3,0],[44,6,3,0,"_utilsSecureStorage"],[44,25,3,0],[44,28,3,0,"require"],[44,35,3,0],[44,36,3,0,"_dependencyMap"],[44,50,3,0],[45,2,3,0],[45,6,3,0,"secureStorage"],[45,19,3,0],[45,22,3,0,"_interopNamespace"],[45,39,3,0],[45,40,3,0,"_utilsSecureStorage"],[45,59,3,0],[46,2,5,0],[46,8,5,6,"API_URL"],[46,15,5,13],[46,18,5,16,"Constants"],[46,27,5,25],[46,28,5,25,"default"],[46,35,5,25],[46,36,5,26,"expoConfig"],[46,46,5,36],[46,48,5,38,"extra"],[46,53,5,43],[46,55,5,45,"EXPO_PUBLIC_BACKEND_URL"],[46,78,5,68],[46,82,5,68,"_expoVirtualEnv"],[46,97,5,68],[46,98,5,68,"env"],[46,101,5,68],[46,102,5,68,"EXPO_PUBLIC_BACKEND_URL"],[46,125,5,107],[46,129,5,111],[46,131,5,113],[47,2,7,7],[47,8,7,13,"api"],[47,11,7,16],[47,14,7,19,"axios"],[47,19,7,24],[47,20,7,24,"default"],[47,27,7,24],[47,28,7,25,"create"],[47,34,7,31],[47,35,7,32],[48,4,8,2,"baseURL"],[48,11,8,9],[48,13,8,11],[48,16,8,14,"API_URL"],[48,23,8,21],[48,29,8,27],[49,4,9,2,"headers"],[49,11,9,9],[49,13,9,11],[50,6,10,4],[50,20,10,18],[50,22,10,20],[51,4,11,2],[52,2,12,0],[52,3,12,1],[52,4,12,2],[54,2,14,0],[55,2,15,0,"api"],[55,5,15,3],[55,6,15,4,"interceptors"],[55,18,15,16],[55,19,15,17,"request"],[55,26,15,24],[55,27,15,25,"use"],[55,30,15,28],[55,31,16,2],[55,37,16,9,"config"],[55,43,16,15],[55,47,16,20],[56,4,17,4],[56,10,17,10,"token"],[56,15,17,15],[56,18,17,18],[56,24,17,24,"secureStorage"],[56,37,17,37],[56,38,17,38,"getItem"],[56,45,17,45],[56,46,17,46],[56,60,17,60],[56,61,17,61],[57,4,18,4],[57,8,18,8,"token"],[57,13,18,13],[57,15,18,15],[58,6,19,6,"config"],[58,12,19,12],[58,13,19,13,"headers"],[58,20,19,20],[58,21,19,21,"Authorization"],[58,34,19,34],[58,37,19,37],[58,47,19,47,"token"],[58,52,19,52],[58,54,19,54],[59,4,20,4],[60,4,21,4],[60,11,21,11,"config"],[60,17,21,17],[61,2,22,2],[61,3,22,3],[61,5,23,3,"error"],[61,10,23,8],[61,14,23,13],[62,4,24,4],[62,11,24,11,"Promise"],[62,18,24,18],[62,19,24,19,"reject"],[62,25,24,25],[62,26,24,26,"error"],[62,31,24,31],[62,32,24,32],[63,2,25,2],[63,3,26,0],[63,4,26,1],[65,2,28,0],[66,2,29,0,"api"],[66,5,29,3],[66,6,29,4,"interceptors"],[66,18,29,16],[66,19,29,17,"response"],[66,27,29,25],[66,28,29,26,"use"],[66,31,29,29],[66,32,30,3,"response"],[66,40,30,11],[66,44,30,16,"response"],[66,52,30,24],[66,54,31,2],[66,60,31,9,"error"],[66,65,31,14],[66,69,31,19],[67,4,32,4],[67,10,32,10,"originalRequest"],[67,25,32,25],[67,28,32,28,"error"],[67,33,32,33],[67,34,32,34,"config"],[67,40,32,40],[68,4,34,4],[68,8,34,8,"error"],[68,13,34,13],[68,14,34,14,"response"],[68,22,34,22],[68,24,34,24,"status"],[68,30,34,30],[68,35,34,35],[68,38,34,38],[68,42,34,42],[68,43,34,43,"originalRequest"],[68,58,34,58],[68,59,34,59,"_retry"],[68,65,34,65],[68,67,34,67],[69,6,35,6,"originalRequest"],[69,21,35,21],[69,22,35,22,"_retry"],[69,28,35,28],[69,31,35,31],[69,35,35,35],[70,6,37,6],[70,10,37,10],[71,8,38,8],[71,14,38,14,"refreshToken"],[71,26,38,26],[71,29,38,29],[71,35,38,35,"secureStorage"],[71,48,38,48],[71,49,38,49,"getItem"],[71,56,38,56],[71,57,38,57],[71,72,38,72],[71,73,38,73],[72,8,39,8],[72,12,39,12,"refreshToken"],[72,24,39,24],[72,26,39,26],[73,10,40,10],[73,16,40,16,"response"],[73,24,40,24],[73,27,40,27],[73,33,40,33,"axios"],[73,38,40,38],[73,39,40,38,"default"],[73,46,40,38],[73,47,40,39,"post"],[73,51,40,43],[73,52,40,44],[73,55,40,47,"API_URL"],[73,62,40,54],[73,81,40,73],[73,83,40,75],[74,12,41,12,"refresh_token"],[74,25,41,25],[74,27,41,27,"refreshToken"],[75,10,42,10],[75,11,42,11],[75,12,42,12],[76,10,44,10],[76,16,44,16],[77,12,44,18,"access_token"],[77,24,44,30],[78,12,44,32,"refresh_token"],[78,25,44,45],[78,27,44,47,"newRefreshToken"],[79,10,44,63],[79,11,44,64],[79,14,44,67,"response"],[79,22,44,75],[79,23,44,76,"data"],[79,27,44,80],[80,10,45,10],[80,16,45,16,"secureStorage"],[80,29,45,29],[80,30,45,30,"setItem"],[80,37,45,37],[80,38,45,38],[80,52,45,52],[80,54,45,54,"access_token"],[80,66,45,66],[80,67,45,67],[81,10,46,10],[81,16,46,16,"secureStorage"],[81,29,46,29],[81,30,46,30,"setItem"],[81,37,46,37],[81,38,46,38],[81,53,46,53],[81,55,46,55,"newRefreshToken"],[81,70,46,70],[81,71,46,71],[82,10,48,10,"originalRequest"],[82,25,48,25],[82,26,48,26,"headers"],[82,33,48,33],[82,34,48,34,"Authorization"],[82,47,48,47],[82,50,48,50],[82,60,48,60,"access_token"],[82,72,48,72],[82,74,48,74],[83,10,49,10],[83,17,49,17,"api"],[83,20,49,20],[83,21,49,21,"originalRequest"],[83,36,49,36],[83,37,49,37],[84,8,50,8],[85,6,51,6],[85,7,51,7],[85,8,51,8],[85,15,51,15,"refreshError"],[85,27,51,27],[85,29,51,29],[86,8,52,8],[87,8,53,8],[87,14,53,14,"secureStorage"],[87,27,53,27],[87,28,53,28,"deleteItem"],[87,38,53,38],[87,39,53,39],[87,53,53,53],[87,54,53,54],[88,8,54,8],[88,14,54,14,"secureStorage"],[88,27,54,27],[88,28,54,28,"deleteItem"],[88,38,54,38],[88,39,54,39],[88,54,54,54],[88,55,54,55],[89,8,55,8],[89,15,55,15,"Promise"],[89,22,55,22],[89,23,55,23,"reject"],[89,29,55,29],[89,30,55,30,"refreshError"],[89,42,55,42],[89,43,55,43],[90,6,56,6],[91,4,57,4],[92,4,59,4],[92,11,59,11,"Promise"],[92,18,59,18],[92,19,59,19,"reject"],[92,25,59,25],[92,26,59,26,"error"],[92,31,59,31],[92,32,59,32],[93,2,60,2],[93,3,61,0],[93,4,61,1],[94,2,63,0],[94,6,63,0,"_default"],[94,14,63,0],[94,17,63,15,"api"],[94,20,63,18],[95,0,63,19],[95,3]],"functionMap":{"names":["<global>","interceptors.request.use$argument_0","interceptors.request.use$argument_1","interceptors.response.use$argument_0","interceptors.response.use$argument_1"],"mappings":"AAA;ECe;GDM;EEC;GFE;EGK,sBH;EIC;GJ6B"},"hasCjsExports":false},"type":"js/module"}]}