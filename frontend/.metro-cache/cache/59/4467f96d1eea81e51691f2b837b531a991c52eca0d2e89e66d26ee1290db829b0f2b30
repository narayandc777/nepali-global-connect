{"dependencies":[{"name":"axios","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":26,"index":26}}],"key":"e45rENb5cSu0Yeh6oC1uWb7lEp4=","exportNames":["*"],"imports":1}},{"name":"expo-constants","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":27},"end":{"line":2,"column":39,"index":66}}],"key":"pPv5KzfRT0rL6NCr7G9k0o4d1W8=","exportNames":["*"],"imports":1}},{"name":"../utils/secureStorage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":67},"end":{"line":3,"column":56,"index":123}}],"key":"VJtuFUlbX461VIgg9agIAV15XNA=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  Object.defineProperty(exports, \"api\", {\n    enumerable: true,\n    get: function () {\n      return api;\n    }\n  });\n  var _axios = require(_dependencyMap[0], \"axios\");\n  var axios = _interopDefault(_axios);\n  var _expoConstants = require(_dependencyMap[1], \"expo-constants\");\n  var Constants = _interopDefault(_expoConstants);\n  var _utilsSecureStorage = require(_dependencyMap[2], \"../utils/secureStorage\");\n  var secureStorage = _interopNamespace(_utilsSecureStorage);\n  const API_URL = Constants.default.expoConfig?.extra?.EXPO_PUBLIC_BACKEND_URL || process.env.EXPO_PUBLIC_BACKEND_URL || '';\n  const api = axios.default.create({\n    baseURL: `${API_URL}/api`,\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  });\n\n  // Request interceptor to add token\n  api.interceptors.request.use(async config => {\n    const token = await secureStorage.getItem('access_token');\n    if (token) {\n      config.headers.Authorization = `Bearer ${token}`;\n    }\n    return config;\n  }, error => {\n    return Promise.reject(error);\n  });\n\n  // Response interceptor to handle token refresh\n  api.interceptors.response.use(response => response, async error => {\n    const originalRequest = error.config;\n    if (error.response?.status === 401 && !originalRequest._retry) {\n      originalRequest._retry = true;\n      try {\n        const refreshToken = await secureStorage.getItem('refresh_token');\n        if (refreshToken) {\n          const response = await axios.default.post(`${API_URL}/api/auth/refresh`, {\n            refresh_token: refreshToken\n          });\n          const {\n            access_token,\n            refresh_token: newRefreshToken\n          } = response.data;\n          await secureStorage.setItem('access_token', access_token);\n          await secureStorage.setItem('refresh_token', newRefreshToken);\n          originalRequest.headers.Authorization = `Bearer ${access_token}`;\n          return api(originalRequest);\n        }\n      } catch (refreshError) {\n        // Refresh failed, logout user\n        await secureStorage.deleteItem('access_token');\n        await secureStorage.deleteItem('refresh_token');\n        return Promise.reject(refreshError);\n      }\n    }\n    return Promise.reject(error);\n  });\n  var _default = api;\n});","lineCount":94,"map":[[27,2,63,0,"Object"],[27,8,63,0],[27,9,63,0,"defineProperty"],[27,23,63,0],[27,24,63,0,"exports"],[27,31,63,0],[28,4,63,0,"enumerable"],[28,14,63,0],[29,4,63,0,"get"],[29,7,63,0],[29,18,63,0,"get"],[29,19,63,0],[30,6,63,0],[30,13,63,0,"_default"],[30,21,63,0],[31,4,63,0],[32,2,63,0],[33,2,7,0,"Object"],[33,8,7,0],[33,9,7,0,"defineProperty"],[33,23,7,0],[33,24,7,0,"exports"],[33,31,7,0],[34,4,7,0,"enumerable"],[34,14,7,0],[35,4,7,0,"get"],[35,7,7,0],[35,18,7,0,"get"],[35,19,7,0],[36,6,7,0],[36,13,7,0,"api"],[36,16,7,0],[37,4,7,0],[38,2,7,0],[39,2,1,0],[39,6,1,0,"_axios"],[39,12,1,0],[39,15,1,0,"require"],[39,22,1,0],[39,23,1,0,"_dependencyMap"],[39,37,1,0],[40,2,1,0],[40,6,1,0,"axios"],[40,11,1,0],[40,14,1,0,"_interopDefault"],[40,29,1,0],[40,30,1,0,"_axios"],[40,36,1,0],[41,2,2,0],[41,6,2,0,"_expoConstants"],[41,20,2,0],[41,23,2,0,"require"],[41,30,2,0],[41,31,2,0,"_dependencyMap"],[41,45,2,0],[42,2,2,0],[42,6,2,0,"Constants"],[42,15,2,0],[42,18,2,0,"_interopDefault"],[42,33,2,0],[42,34,2,0,"_expoConstants"],[42,48,2,0],[43,2,3,0],[43,6,3,0,"_utilsSecureStorage"],[43,25,3,0],[43,28,3,0,"require"],[43,35,3,0],[43,36,3,0,"_dependencyMap"],[43,50,3,0],[44,2,3,0],[44,6,3,0,"secureStorage"],[44,19,3,0],[44,22,3,0,"_interopNamespace"],[44,39,3,0],[44,40,3,0,"_utilsSecureStorage"],[44,59,3,0],[45,2,5,0],[45,8,5,6,"API_URL"],[45,15,5,13],[45,18,5,16,"Constants"],[45,27,5,25],[45,28,5,25,"default"],[45,35,5,25],[45,36,5,26,"expoConfig"],[45,46,5,36],[45,48,5,38,"extra"],[45,53,5,43],[45,55,5,45,"EXPO_PUBLIC_BACKEND_URL"],[45,78,5,68],[45,82,5,72,"process"],[45,89,5,79],[45,90,5,80,"env"],[45,93,5,83],[45,94,5,84,"EXPO_PUBLIC_BACKEND_URL"],[45,117,5,107],[45,121,5,111],[45,123,5,113],[46,2,7,7],[46,8,7,13,"api"],[46,11,7,16],[46,14,7,19,"axios"],[46,19,7,24],[46,20,7,24,"default"],[46,27,7,24],[46,28,7,25,"create"],[46,34,7,31],[46,35,7,32],[47,4,8,2,"baseURL"],[47,11,8,9],[47,13,8,11],[47,16,8,14,"API_URL"],[47,23,8,21],[47,29,8,27],[48,4,9,2,"headers"],[48,11,9,9],[48,13,9,11],[49,6,10,4],[49,20,10,18],[49,22,10,20],[50,4,11,2],[51,2,12,0],[51,3,12,1],[51,4,12,2],[53,2,14,0],[54,2,15,0,"api"],[54,5,15,3],[54,6,15,4,"interceptors"],[54,18,15,16],[54,19,15,17,"request"],[54,26,15,24],[54,27,15,25,"use"],[54,30,15,28],[54,31,16,2],[54,37,16,9,"config"],[54,43,16,15],[54,47,16,20],[55,4,17,4],[55,10,17,10,"token"],[55,15,17,15],[55,18,17,18],[55,24,17,24,"secureStorage"],[55,37,17,37],[55,38,17,38,"getItem"],[55,45,17,45],[55,46,17,46],[55,60,17,60],[55,61,17,61],[56,4,18,4],[56,8,18,8,"token"],[56,13,18,13],[56,15,18,15],[57,6,19,6,"config"],[57,12,19,12],[57,13,19,13,"headers"],[57,20,19,20],[57,21,19,21,"Authorization"],[57,34,19,34],[57,37,19,37],[57,47,19,47,"token"],[57,52,19,52],[57,54,19,54],[58,4,20,4],[59,4,21,4],[59,11,21,11,"config"],[59,17,21,17],[60,2,22,2],[60,3,22,3],[60,5,23,3,"error"],[60,10,23,8],[60,14,23,13],[61,4,24,4],[61,11,24,11,"Promise"],[61,18,24,18],[61,19,24,19,"reject"],[61,25,24,25],[61,26,24,26,"error"],[61,31,24,31],[61,32,24,32],[62,2,25,2],[62,3,26,0],[62,4,26,1],[64,2,28,0],[65,2,29,0,"api"],[65,5,29,3],[65,6,29,4,"interceptors"],[65,18,29,16],[65,19,29,17,"response"],[65,27,29,25],[65,28,29,26,"use"],[65,31,29,29],[65,32,30,3,"response"],[65,40,30,11],[65,44,30,16,"response"],[65,52,30,24],[65,54,31,2],[65,60,31,9,"error"],[65,65,31,14],[65,69,31,19],[66,4,32,4],[66,10,32,10,"originalRequest"],[66,25,32,25],[66,28,32,28,"error"],[66,33,32,33],[66,34,32,34,"config"],[66,40,32,40],[67,4,34,4],[67,8,34,8,"error"],[67,13,34,13],[67,14,34,14,"response"],[67,22,34,22],[67,24,34,24,"status"],[67,30,34,30],[67,35,34,35],[67,38,34,38],[67,42,34,42],[67,43,34,43,"originalRequest"],[67,58,34,58],[67,59,34,59,"_retry"],[67,65,34,65],[67,67,34,67],[68,6,35,6,"originalRequest"],[68,21,35,21],[68,22,35,22,"_retry"],[68,28,35,28],[68,31,35,31],[68,35,35,35],[69,6,37,6],[69,10,37,10],[70,8,38,8],[70,14,38,14,"refreshToken"],[70,26,38,26],[70,29,38,29],[70,35,38,35,"secureStorage"],[70,48,38,48],[70,49,38,49,"getItem"],[70,56,38,56],[70,57,38,57],[70,72,38,72],[70,73,38,73],[71,8,39,8],[71,12,39,12,"refreshToken"],[71,24,39,24],[71,26,39,26],[72,10,40,10],[72,16,40,16,"response"],[72,24,40,24],[72,27,40,27],[72,33,40,33,"axios"],[72,38,40,38],[72,39,40,38,"default"],[72,46,40,38],[72,47,40,39,"post"],[72,51,40,43],[72,52,40,44],[72,55,40,47,"API_URL"],[72,62,40,54],[72,81,40,73],[72,83,40,75],[73,12,41,12,"refresh_token"],[73,25,41,25],[73,27,41,27,"refreshToken"],[74,10,42,10],[74,11,42,11],[74,12,42,12],[75,10,44,10],[75,16,44,16],[76,12,44,18,"access_token"],[76,24,44,30],[77,12,44,32,"refresh_token"],[77,25,44,45],[77,27,44,47,"newRefreshToken"],[78,10,44,63],[78,11,44,64],[78,14,44,67,"response"],[78,22,44,75],[78,23,44,76,"data"],[78,27,44,80],[79,10,45,10],[79,16,45,16,"secureStorage"],[79,29,45,29],[79,30,45,30,"setItem"],[79,37,45,37],[79,38,45,38],[79,52,45,52],[79,54,45,54,"access_token"],[79,66,45,66],[79,67,45,67],[80,10,46,10],[80,16,46,16,"secureStorage"],[80,29,46,29],[80,30,46,30,"setItem"],[80,37,46,37],[80,38,46,38],[80,53,46,53],[80,55,46,55,"newRefreshToken"],[80,70,46,70],[80,71,46,71],[81,10,48,10,"originalRequest"],[81,25,48,25],[81,26,48,26,"headers"],[81,33,48,33],[81,34,48,34,"Authorization"],[81,47,48,47],[81,50,48,50],[81,60,48,60,"access_token"],[81,72,48,72],[81,74,48,74],[82,10,49,10],[82,17,49,17,"api"],[82,20,49,20],[82,21,49,21,"originalRequest"],[82,36,49,36],[82,37,49,37],[83,8,50,8],[84,6,51,6],[84,7,51,7],[84,8,51,8],[84,15,51,15,"refreshError"],[84,27,51,27],[84,29,51,29],[85,8,52,8],[86,8,53,8],[86,14,53,14,"secureStorage"],[86,27,53,27],[86,28,53,28,"deleteItem"],[86,38,53,38],[86,39,53,39],[86,53,53,53],[86,54,53,54],[87,8,54,8],[87,14,54,14,"secureStorage"],[87,27,54,27],[87,28,54,28,"deleteItem"],[87,38,54,38],[87,39,54,39],[87,54,54,54],[87,55,54,55],[88,8,55,8],[88,15,55,15,"Promise"],[88,22,55,22],[88,23,55,23,"reject"],[88,29,55,29],[88,30,55,30,"refreshError"],[88,42,55,42],[88,43,55,43],[89,6,56,6],[90,4,57,4],[91,4,59,4],[91,11,59,11,"Promise"],[91,18,59,18],[91,19,59,19,"reject"],[91,25,59,25],[91,26,59,26,"error"],[91,31,59,31],[91,32,59,32],[92,2,60,2],[92,3,61,0],[92,4,61,1],[93,2,63,0],[93,6,63,0,"_default"],[93,14,63,0],[93,17,63,15,"api"],[93,20,63,18],[94,0,63,19],[94,3]],"functionMap":{"names":["<global>","interceptors.request.use$argument_0","interceptors.request.use$argument_1","interceptors.response.use$argument_0","interceptors.response.use$argument_1"],"mappings":"AAA;ECe;GDM;EEC;GFE;EGK,sBH;EIC;GJ6B"},"hasCjsExports":false},"type":"js/module"}]}